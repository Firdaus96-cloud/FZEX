(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{8154:function(e,t,n){Promise.resolve().then(n.bind(n,320))},6463:function(e,t,n){"use strict";var a=n(1169);n.o(a,"redirect")&&n.d(t,{redirect:function(){return a.redirect}}),n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}})},320:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(7437);n(1540);var s=n(4551),r=n(2546),l=n(998);n(6648),n(7138);var i=n(6463),d=n(2265),u=n(8726);function o(){let e=(0,l.useSession)(),[t,n]=(0,d.useState)(null),[o,c]=(0,d.useState)(!1),[h,m]=(0,d.useState)(!1),{status:f}=e;async function p(e,t){e.preventDefault();let n=new Promise(async(e,n)=>{(await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?e():n()});await u.ZP.promise(n,{loading:"Saving...",success:"Profile saved!",error:"Error"})}return((0,d.useEffect)(()=>{"authenticated"===f&&fetch("/api/profile").then(e=>{e.json().then(e=>{n(e),c(e.admin),m(!0)})})},[e,f]),"loading"!==f&&h)?"unauthenticated"===f?(0,i.redirect)("/login"):(0,a.jsxs)("section",{className:"mt-8",children:[(0,a.jsx)(r.Z,{isAdmin:o}),(0,a.jsx)("div",{className:"max-w-2xl mx-auto mt-8",children:(0,a.jsx)(s.Z,{user:t,onSave:p})})]}):"Loading..."}},8497:function(e,t,n){"use strict";n.d(t,{U:function(){return s}});var a=n(2265);function s(){let[e,t]=(0,a.useState)(!1),[n,s]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{s(!0),fetch("/api/profile").then(e=>{e.json().then(e=>{t(e),s(!1)})})},[]),{loading:n,data:e}}},7998:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(7437);function s(e){let{addressProps:t,setAddressProp:n,disabled:s=!1}=e,{phone:r,streetAddress:l,postalCode:i,city:d,country:u}=t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{children:"Phone"}),(0,a.jsx)("input",{disabled:s,type:"tel",placeholder:"Phone number",value:r||"",onChange:e=>n("phone",e.target.value)}),(0,a.jsx)("label",{children:"Street address"}),(0,a.jsx)("input",{disabled:s,type:"text",placeholder:"Street address",value:l||"",onChange:e=>n("streetAddress",e.target.value)}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Postal code"}),(0,a.jsx)("input",{disabled:s,type:"text",placeholder:"Postal code",value:i||"",onChange:e=>n("postalCode",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"City"}),(0,a.jsx)("input",{disabled:s,type:"text",placeholder:"City",value:d||"",onChange:e=>n("city",e.target.value)})]})]}),(0,a.jsx)("label",{children:"Country"}),(0,a.jsx)("input",{disabled:s,type:"text",placeholder:"Country",value:u||"",onChange:e=>n("country",e.target.value)})]})}},1540:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(7437),s=n(6648),r=n(8726);function l(e){let{link:t,setLink:n}=e;async function l(e){let t=e.target.files;if((null==t?void 0:t.length)===1){let e=new FormData;e.set("file",t[0]);let a=fetch("/api/upload",{method:"POST",body:e}).then(e=>{if(console.log(e.json()),e.ok)return e.json().then(e=>{n(e)});throw Error("Something went wrong")});await r.ZP.promise(a,{loading:"Uploading...",success:"Upload complete",error:"Upload error"})}}return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)(s.default,{className:"rounded-lg w-full h-full mb-1",src:t,width:250,height:250,alt:"avatar"}),!t&&(0,a.jsx)("div",{className:"text-center bg-gray-200 p-4 text-gray-500 rounded-lg mb-1",children:"No image"}),(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"file",className:"hidden",onChange:l}),(0,a.jsx)("span",{className:"block border border-gray-300 rounded-lg p-2 text-center cursor-pointer",children:"Change image"})]})]})}},4551:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(7437),s=n(7998),r=n(1540),l=n(8497),i=n(2265);function d(e){let{user:t,onSave:n}=e,[d,u]=(0,i.useState)((null==t?void 0:t.name)||""),[o,c]=(0,i.useState)((null==t?void 0:t.image)||""),[h,m]=(0,i.useState)((null==t?void 0:t.phone)||""),[f,p]=(0,i.useState)((null==t?void 0:t.streetAddress)||""),[x,v]=(0,i.useState)((null==t?void 0:t.postalCode)||""),[g,j]=(0,i.useState)((null==t?void 0:t.city)||""),[b,y]=(0,i.useState)((null==t?void 0:t.country)||""),[N,S]=(0,i.useState)((null==t?void 0:t.admin)||!1),{data:C}=(0,l.U)();return(0,a.jsxs)("div",{className:"md:flex gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"p-2 rounded-lg relative max-w-[120px]",children:(0,a.jsx)(r.Z,{link:o,setLink:c})})}),(0,a.jsxs)("form",{className:"grow",onSubmit:e=>n(e,{name:d,image:o,phone:h,admin:N,streetAddress:f,city:g,country:b,postalCode:x}),children:[(0,a.jsx)("label",{children:"First and last name"}),(0,a.jsx)("input",{type:"text",placeholder:"First and last name",value:d,onChange:e=>u(e.target.value)}),(0,a.jsx)("label",{children:"Email"}),(0,a.jsx)("input",{type:"email",disabled:!0,value:t.email,placeholder:"email"}),(0,a.jsx)(s.Z,{addressProps:{phone:h,streetAddress:f,postalCode:x,city:g,country:b},setAddressProp:function(e,t){"phone"===e&&m(t),"streetAddress"===e&&p(t),"postalCode"===e&&v(t),"city"===e&&j(t),"country"===e&&y(t)}}),C.admin&&(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"p-2 inline-flex items-center gap-2 mb-2",htmlFor:"adminCb",children:[(0,a.jsx)("input",{id:"adminCb",type:"checkbox",className:"",value:"1",checked:N,onChange:e=>S(e.target.checked)}),(0,a.jsx)("span",{children:"Admin"})]})}),(0,a.jsx)("button",{type:"submit",children:"Save"})]})]})}},2546:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(7437),s=n(7138),r=n(6463);function l(e){let{isAdmin:t}=e,n=(0,r.usePathname)();return(0,a.jsxs)("div",{className:"flex mx-auto gap-2 tabs justify-center flex-wrap",children:[(0,a.jsx)(s.default,{className:"/profile"===n?"active":"",href:"/profile",children:"Profile"}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.default,{href:"/categories",className:"/categories"===n?"active":"",children:"Categories"}),(0,a.jsx)(s.default,{href:"/menu-items",className:n.includes("menu-items")?"active":"",children:"Menu Items"}),(0,a.jsx)(s.default,{className:n.includes("/users")?"active":"",href:"/users",children:"Users"})]}),(0,a.jsx)(s.default,{className:"/orders"===n?"active":"",href:"/orders",children:"Orders"})]})}}},function(e){e.O(0,[138,648,726,998,971,23,744],function(){return e(e.s=8154)}),_N_E=e.O()}]);